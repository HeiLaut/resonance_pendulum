C / sqrt((f0^2 - f^2)^2 + (gam * f)^2)
library(tidyverse)
setwd("~/Nextcloud/Physik/DIY/Rad Pohl/Messwerte")
df <- read.csv("V2.csv",header = TRUE)
df$F_Hz <- 1/(df$T_s)
ggplot(df, aes(x = F_Hz, y = A_Skt)) +
geom_point()
fit_data <- data.frame(
F_Hz = seq(from = min(df$F_Hz), to = max(df$F_Hz), length.out = 200)
)
oscillator_func <- function(f, C, f0, gam) {
C / sqrt((f0^2 - f^2)^2 + (gam * f)^2)
}
# 2. Fit mit sinnvollen Startwerten
# f0: Peak-Position (~0.75)
# gam: Breite (~0.1)
# C: Schätzung -> Amplitude * f0 * gam (grob 11 * 0.75 * 0.1 ≈ 0.8)
fit_phys <- nls(A_Skt ~ oscillator_func(F_Hz, C, f0, gam),
data = df,
start = list(C = 8, f0 = 0.74, gam = 0.4))
# 3. Vorhersage für den Plot
fit_data$A_fit_phys <- predict(fit_phys, newdata = list(F_Hz = fit_data$F_Hz))
# 4. Plotten
ggplot(df, aes(x = F_Hz, y = A_Skt)) +
geom_point() +
geom_line(data = fit_data, aes(F_Hz, A_fit_phys), color = "red", size = 0.75) +
labs( x = "f in Hz", y = "Amplitude") +
theme_minimal()
